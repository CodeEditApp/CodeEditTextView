{"sections":[],"kind":"symbol","identifier":{"url":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLayoutManager\/determineVisiblePosition(for:)","interfaceLanguage":"swift"},"metadata":{"symbolKind":"method","roleHeading":"Instance Method","role":"symbol","extendedModule":"CodeEditTextView","fragments":[{"kind":"keyword","text":"func"},{"text":" ","kind":"text"},{"text":"determineVisiblePosition","kind":"identifier"},{"text":"(","kind":"text"},{"text":"for","kind":"externalParam"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC","text":"TextLineStorage"},{"kind":"text","text":"<"},{"text":"TextLine","preciseIdentifier":"s:16CodeEditTextView0C4LineC","kind":"typeIdentifier"},{"kind":"text","text":">."},{"preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC0cE8PositionV","text":"TextLinePosition","kind":"typeIdentifier"},{"text":"?) -> (position","kind":"text"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC","text":"TextLineStorage"},{"text":"<","kind":"text"},{"kind":"typeIdentifier","text":"TextLine","preciseIdentifier":"s:16CodeEditTextView0C4LineC"},{"text":">.","kind":"text"},{"kind":"typeIdentifier","text":"TextLinePosition","preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC0cE8PositionV"},{"kind":"text","text":", indexRange"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","preciseIdentifier":"s:SN","text":"ClosedRange"},{"text":"<","kind":"text"},{"text":"Int","preciseIdentifier":"s:Si","kind":"typeIdentifier"},{"text":">)?","kind":"text"}],"modules":[{"name":"CodeEditTextView"}],"externalID":"s:16CodeEditTextView0C13LayoutManagerC24determineVisiblePosition3forAA0C11LineStorageC0ckI0VyAA0cK0C_G8position_SNySiG10indexRangetSgALSg_tF","title":"determineVisiblePosition(for:)"},"hierarchy":{"paths":[["doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView","doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLayoutManager"]]},"variants":[{"paths":["\/documentation\/codeedittextview\/textlayoutmanager\/determinevisibleposition(for:)"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"kind":"declarations","declarations":[{"platforms":["macOS"],"languages":["swift"],"tokens":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"determineVisiblePosition"},{"text":"(","kind":"text"},{"text":"for","kind":"externalParam"},{"kind":"text","text":" "},{"kind":"internalParam","text":"originalPosition"},{"kind":"text","text":": "},{"identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLineStorage","kind":"typeIdentifier","text":"TextLineStorage","preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC"},{"kind":"text","text":"<"},{"text":"TextLine","kind":"typeIdentifier","preciseIdentifier":"s:16CodeEditTextView0C4LineC","identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLine"},{"kind":"text","text":">."},{"text":"TextLinePosition","preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC0cE8PositionV","kind":"typeIdentifier","identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLineStorage\/TextLinePosition"},{"kind":"text","text":"?) -> (position"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC","text":"TextLineStorage","identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLineStorage","kind":"typeIdentifier"},{"text":"<","kind":"text"},{"identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLine","preciseIdentifier":"s:16CodeEditTextView0C4LineC","text":"TextLine","kind":"typeIdentifier"},{"text":">.","kind":"text"},{"preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC0cE8PositionV","identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLineStorage\/TextLinePosition","text":"TextLinePosition","kind":"typeIdentifier"},{"text":", indexRange","kind":"text"},{"kind":"text","text":": "},{"preciseIdentifier":"s:SN","text":"ClosedRange","kind":"typeIdentifier"},{"kind":"text","text":"<"},{"preciseIdentifier":"s:Si","text":"Int","kind":"typeIdentifier"},{"text":">)?","kind":"text"}]}]},{"parameters":[{"name":"originalPosition","content":[{"inlineContent":[{"text":"The initial ","type":"text"},{"type":"codeVoice","code":"TextLinePosition"},{"type":"text","text":" to inspect."},{"type":"text","text":" "},{"type":"text","text":"Pass in the position you got from "},{"type":"codeVoice","code":"lineStorage.getLine(atOffset:)"},{"type":"text","text":" or similar."}],"type":"paragraph"}]}],"kind":"parameters"},{"content":[{"level":2,"anchor":"return-value","type":"heading","text":"Return Value"},{"type":"paragraph","inlineContent":[{"type":"text","text":"A tuple containing "},{"type":"codeVoice","code":"position"},{"type":"text","text":": A "},{"type":"codeVoice","code":"TextLinePosition"},{"type":"text","text":" whose "},{"code":"range","type":"codeVoice"},{"type":"text","text":" and "},{"type":"codeVoice","code":"index"},{"type":"text","text":" have been"},{"type":"text","text":" "},{"text":"adjusted to include any attachment‐spanned lines.. ","type":"text"},{"type":"codeVoice","code":"indexRange"},{"type":"text","text":": A "},{"code":"ClosedRange<Int>","type":"codeVoice"},{"type":"text","text":" listing all of"},{"text":" ","type":"text"},{"type":"text","text":"the line indices that are now covered by the returned position."},{"text":" ","type":"text"},{"type":"text","text":"Returns "},{"code":"nil","type":"codeVoice"},{"text":" if ","type":"text"},{"type":"codeVoice","code":"originalPosition"},{"type":"text","text":" is "},{"code":"nil","type":"codeVoice"},{"text":".","type":"text"}]}],"kind":"content"},{"content":[{"level":2,"anchor":"discussion","text":"Discussion","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"For example, given the following:  ","type":"text"},{"inlineContent":[{"type":"text","text":"("},{"type":"codeVoice","code":"["},{"text":" == attachment start, ","type":"text"},{"type":"codeVoice","code":"]"},{"text":" == attachment end)","type":"text"}],"type":"emphasis"}]},{"code":["Line 1","Line[ 2","Line 3","Line] 4"],"syntax":null,"type":"codeListing"},{"type":"paragraph","inlineContent":[{"text":"If you start at the position for “Line 2”, the first and last attachments","type":"text"},{"text":" ","type":"text"},{"text":"overlap lines 2–4, so this method will extend the range to cover lines 2–4","type":"text"},{"type":"text","text":" "},{"text":"and return a position whose ","type":"text"},{"code":"range","type":"codeVoice"},{"type":"text","text":" spans the entire attachment."}]},{"text":"Why recursion?","type":"heading","anchor":"Why-recursion","level":1},{"type":"paragraph","inlineContent":[{"type":"text","text":"When an attachment extends the visible range, it may pull in new lines that themselves overlap other"},{"type":"text","text":" "},{"type":"text","text":"attachments. A simple one‐pass merge wouldn’t catch those secondary overlaps. By calling"},{"text":" ","type":"text"},{"type":"text","text":"determineVisiblePosition again on the newly extended range, we ensure that all cascading attachments—no matter"},{"text":" ","type":"text"},{"text":"how many lines they span—are folded into a single, coherent TextLinePosition before returning.","type":"text"}]}],"kind":"content"}],"abstract":[{"type":"text","text":"Determines the “visible” line position by merging any consecutive lines"},{"text":" ","type":"text"},{"type":"text","text":"that are spanned by text attachments. If an attachment overlaps beyond the"},{"type":"text","text":" "},{"text":"bounds of the original line, this method will extend the returned range to","type":"text"},{"type":"text","text":" "},{"text":"cover the full span of those attachments (and recurse if further attachments","type":"text"},{"type":"text","text":" "},{"type":"text","text":"cross into newly included lines)."}],"schemaVersion":{"patch":0,"minor":3,"major":0},"references":{"doc://codeedittextview.CodeEditTextView/documentation/CodeEditTextView/TextLineStorage":{"navigatorTitle":[{"kind":"identifier","text":"TextLineStorage"}],"identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLineStorage","type":"topic","url":"\/documentation\/codeedittextview\/textlinestorage","title":"TextLineStorage","abstract":[{"type":"text","text":"Implements a red-black tree for efficiently editing, storing and retrieving lines of text in a document."}],"role":"symbol","fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"TextLineStorage","kind":"identifier"}],"kind":"symbol"},"doc://codeedittextview.CodeEditTextView/documentation/CodeEditTextView/TextLineStorage/TextLinePosition":{"kind":"symbol","role":"symbol","fragments":[{"kind":"keyword","text":"struct"},{"text":" ","kind":"text"},{"kind":"identifier","text":"TextLinePosition"}],"navigatorTitle":[{"kind":"identifier","text":"TextLinePosition"}],"url":"\/documentation\/codeedittextview\/textlinestorage\/textlineposition","title":"TextLineStorage.TextLinePosition","abstract":[],"identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLineStorage\/TextLinePosition","type":"topic","conformance":{"availabilityPrefix":[{"text":"Available when","type":"text"}],"constraints":[{"type":"codeVoice","code":"Data"},{"type":"text","text":" conforms to "},{"type":"codeVoice","code":"Identifiable"},{"type":"text","text":"."}],"conformancePrefix":[{"text":"Conforms when","type":"text"}]}},"doc://codeedittextview.CodeEditTextView/documentation/CodeEditTextView/TextLayoutManager":{"role":"symbol","identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLayoutManager","url":"\/documentation\/codeedittextview\/textlayoutmanager","title":"TextLayoutManager","navigatorTitle":[{"text":"TextLayoutManager","kind":"identifier"}],"type":"topic","abstract":[{"type":"text","text":"The text layout manager manages laying out lines in a code document."}],"kind":"symbol","fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"text":"TextLayoutManager","kind":"identifier"}]},"doc://codeedittextview.CodeEditTextView/documentation/CodeEditTextView/TextLine":{"identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLine","type":"topic","kind":"symbol","role":"symbol","title":"TextLine","abstract":[{"text":"Represents a displayable line of text.","type":"text"}],"url":"\/documentation\/codeedittextview\/textline","fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"TextLine"}],"navigatorTitle":[{"kind":"identifier","text":"TextLine"}]},"doc://codeedittextview.CodeEditTextView/documentation/CodeEditTextView/TextLayoutManager/determineVisiblePosition(for:)":{"role":"symbol","identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView\/TextLayoutManager\/determineVisiblePosition(for:)","url":"\/documentation\/codeedittextview\/textlayoutmanager\/determinevisibleposition(for:)","title":"determineVisiblePosition(for:)","kind":"symbol","type":"topic","abstract":[{"type":"text","text":"Determines the “visible” line position by merging any consecutive lines"},{"type":"text","text":" "},{"text":"that are spanned by text attachments. If an attachment overlaps beyond the","type":"text"},{"type":"text","text":" "},{"type":"text","text":"bounds of the original line, this method will extend the returned range to"},{"type":"text","text":" "},{"text":"cover the full span of those attachments (and recurse if further attachments","type":"text"},{"text":" ","type":"text"},{"type":"text","text":"cross into newly included lines)."}],"fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"determineVisiblePosition","kind":"identifier"},{"text":"(","kind":"text"},{"text":"for","kind":"externalParam"},{"kind":"text","text":": "},{"text":"TextLineStorage","preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC","kind":"typeIdentifier"},{"text":"<","kind":"text"},{"text":"TextLine","kind":"typeIdentifier","preciseIdentifier":"s:16CodeEditTextView0C4LineC"},{"kind":"text","text":">."},{"kind":"typeIdentifier","preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC0cE8PositionV","text":"TextLinePosition"},{"text":"?) -> (position","kind":"text"},{"text":": ","kind":"text"},{"text":"TextLineStorage","preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC","kind":"typeIdentifier"},{"kind":"text","text":"<"},{"preciseIdentifier":"s:16CodeEditTextView0C4LineC","text":"TextLine","kind":"typeIdentifier"},{"text":">.","kind":"text"},{"preciseIdentifier":"s:16CodeEditTextView0C11LineStorageC0cE8PositionV","text":"TextLinePosition","kind":"typeIdentifier"},{"kind":"text","text":", indexRange"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:SN","kind":"typeIdentifier","text":"ClosedRange"},{"kind":"text","text":"<"},{"kind":"typeIdentifier","preciseIdentifier":"s:Si","text":"Int"},{"kind":"text","text":">)?"}]},"doc://codeedittextview.CodeEditTextView/documentation/CodeEditTextView":{"role":"collection","url":"\/documentation\/codeedittextview","kind":"symbol","title":"CodeEditTextView","type":"topic","abstract":[{"type":"text","text":"A text editor designed to edit code documents."}],"identifier":"doc:\/\/codeedittextview.CodeEditTextView\/documentation\/CodeEditTextView"}}}